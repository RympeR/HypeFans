{"ast":null,"code":"\"use strict\";\n\nvar _extends = require(\"@babel/runtime/helpers/extends\");\n\nvar _regeneratorRuntime = require(\"@babel/runtime/regenerator\");\n\nvar _slicedToArray = require(\"@babel/runtime/helpers/slicedToArray\");\n\nvar _jsxFileName = \"D:\\\\develop\\\\pypr\\\\HypeFans\\\\mobile_version\\\\node_modules\\\\expo-image-editor\\\\lib\\\\ImageEditor.js\";\n\nvar __createBinding = this && this.__createBinding || (Object.create ? function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  Object.defineProperty(o, k2, {\n    enumerable: true,\n    get: function get() {\n      return m[k];\n    }\n  });\n} : function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  o[k2] = m[k];\n});\n\nvar __setModuleDefault = this && this.__setModuleDefault || (Object.create ? function (o, v) {\n  Object.defineProperty(o, \"default\", {\n    enumerable: true,\n    value: v\n  });\n} : function (o, v) {\n  o[\"default\"] = v;\n});\n\nvar __importStar = this && this.__importStar || function (mod) {\n  if (mod && mod.__esModule) return mod;\n  var result = {};\n  if (mod != null) for (var k in mod) {\n    if (k !== \"default\" && Object.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n  }\n\n  __setModuleDefault(result, mod);\n\n  return result;\n};\n\nvar __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n  function adopt(value) {\n    return value instanceof P ? value : new P(function (resolve) {\n      resolve(value);\n    });\n  }\n\n  return new (P || (P = Promise))(function (resolve, reject) {\n    function fulfilled(value) {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function rejected(value) {\n      try {\n        step(generator[\"throw\"](value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function step(result) {\n      result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);\n    }\n\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.ImageEditor = void 0;\n\nvar React = __importStar(require(\"react\"));\n\nvar react_native_1 = require(\"react-native-web/dist/index\");\n\nvar ControlBar_1 = require(\"./ControlBar\");\n\nvar EditingWindow_1 = require(\"./EditingWindow\");\n\nvar ImageManipulator = __importStar(require(\"expo-image-manipulator\"));\n\nvar Processing_1 = require(\"./Processing\");\n\nvar recoil_1 = require(\"recoil\");\n\nvar Store_1 = require(\"./Store\");\n\nvar OperationBar_1 = require(\"./OperationBar/OperationBar\");\n\nvar noScroll = require(\"no-scroll\");\n\nfunction ImageEditorCore(props) {\n  var _this = this;\n\n  var _recoil_1$useRecoilSt = recoil_1.useRecoilState(Store_1.imageBoundsState),\n      _recoil_1$useRecoilSt2 = _slicedToArray(_recoil_1$useRecoilSt, 2),\n      imageBounds = _recoil_1$useRecoilSt2[0],\n      setImageBounds = _recoil_1$useRecoilSt2[1];\n\n  var _recoil_1$useRecoilSt3 = recoil_1.useRecoilState(Store_1.imageDataState),\n      _recoil_1$useRecoilSt4 = _slicedToArray(_recoil_1$useRecoilSt3, 2),\n      imageData = _recoil_1$useRecoilSt4[0],\n      setImageData = _recoil_1$useRecoilSt4[1];\n\n  var _recoil_1$useRecoilSt5 = recoil_1.useRecoilState(Store_1.accumulatedPanState),\n      _recoil_1$useRecoilSt6 = _slicedToArray(_recoil_1$useRecoilSt5, 2),\n      accumulatedPan = _recoil_1$useRecoilSt6[0],\n      setAccumulatedPan = _recoil_1$useRecoilSt6[1];\n\n  var _recoil_1$useRecoilSt7 = recoil_1.useRecoilState(Store_1.imageScaleFactorState),\n      _recoil_1$useRecoilSt8 = _slicedToArray(_recoil_1$useRecoilSt7, 1),\n      imageScaleFactor = _recoil_1$useRecoilSt8[0];\n\n  var _recoil_1$useRecoilSt9 = recoil_1.useRecoilState(Store_1.cropSizeState),\n      _recoil_1$useRecoilSt10 = _slicedToArray(_recoil_1$useRecoilSt9, 2),\n      cropSize = _recoil_1$useRecoilSt10[0],\n      setCropSize = _recoil_1$useRecoilSt10[1];\n\n  var _recoil_1$useRecoilSt11 = recoil_1.useRecoilState(Store_1.readyState),\n      _recoil_1$useRecoilSt12 = _slicedToArray(_recoil_1$useRecoilSt11, 2),\n      ready = _recoil_1$useRecoilSt12[0],\n      setReady = _recoil_1$useRecoilSt12[1];\n\n  var _recoil_1$useRecoilSt13 = recoil_1.useRecoilState(Store_1.processingState),\n      _recoil_1$useRecoilSt14 = _slicedToArray(_recoil_1$useRecoilSt13, 2),\n      processing = _recoil_1$useRecoilSt14[0],\n      setProcessing = _recoil_1$useRecoilSt14[1];\n\n  var _recoil_1$useRecoilSt15 = recoil_1.useRecoilState(Store_1.editingModeState),\n      _recoil_1$useRecoilSt16 = _slicedToArray(_recoil_1$useRecoilSt15, 2),\n      editingMode = _recoil_1$useRecoilSt16[0],\n      setEditingMode = _recoil_1$useRecoilSt16[1];\n\n  var _recoil_1$useRecoilSt17 = recoil_1.useRecoilState(Store_1.fixedCropAspectRatioState),\n      _recoil_1$useRecoilSt18 = _slicedToArray(_recoil_1$useRecoilSt17, 2),\n      setFixedCropAspectRatio = _recoil_1$useRecoilSt18[1];\n\n  var _recoil_1$useRecoilSt19 = recoil_1.useRecoilState(Store_1.lockAspectRatioState),\n      _recoil_1$useRecoilSt20 = _slicedToArray(_recoil_1$useRecoilSt19, 2),\n      setLockAspectRatio = _recoil_1$useRecoilSt20[1];\n\n  var _recoil_1$useRecoilSt21 = recoil_1.useRecoilState(Store_1.minimumCropDimensionsState),\n      _recoil_1$useRecoilSt22 = _slicedToArray(_recoil_1$useRecoilSt21, 2),\n      setMinimumCropDimensions = _recoil_1$useRecoilSt22[1];\n\n  var _recoil_1$useRecoilSt23 = recoil_1.useRecoilState(Store_1.throttleBlurState),\n      _recoil_1$useRecoilSt24 = _slicedToArray(_recoil_1$useRecoilSt23, 2),\n      setThrottleBlur = _recoil_1$useRecoilSt24[1];\n\n  React.useEffect(function () {\n    (function () {\n      return __awaiter(_this, void 0, void 0, _regeneratorRuntime.mark(function _callee() {\n        var enableEditor, img, _yield$ImageManipulat, pickerWidth, pickerHeight;\n\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                if (!props.imageUri) {\n                  _context.next = 15;\n                  break;\n                }\n\n                enableEditor = function enableEditor() {\n                  setReady(true);\n                  noScroll.on();\n                };\n\n                if (!(react_native_1.Platform.OS == \"web\")) {\n                  _context.next = 8;\n                  break;\n                }\n\n                img = document.createElement(\"img\");\n\n                img.onload = function () {\n                  setImageData({\n                    uri: props.imageUri,\n                    height: img.height,\n                    width: img.width\n                  });\n                  enableEditor();\n                };\n\n                img.src = props.imageUri;\n                _context.next = 15;\n                break;\n\n              case 8:\n                _context.next = 10;\n                return ImageManipulator.manipulateAsync(props.imageUri, []);\n\n              case 10:\n                _yield$ImageManipulat = _context.sent;\n                pickerWidth = _yield$ImageManipulat.width;\n                pickerHeight = _yield$ImageManipulat.height;\n                setImageData({\n                  uri: props.imageUri,\n                  width: pickerWidth,\n                  height: pickerHeight\n                });\n                enableEditor();\n\n              case 15:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee);\n      }));\n    })();\n  }, [props.imageUri]);\n  React.useEffect(function () {\n    setFixedCropAspectRatio(props.fixedCropAspectRatio);\n  }, [props.fixedCropAspectRatio]);\n  React.useEffect(function () {\n    setLockAspectRatio(props.lockAspectRatio);\n  }, [props.lockAspectRatio]);\n  React.useEffect(function () {\n    setMinimumCropDimensions(props.minimumCropDimensions);\n  }, [props.minimumCropDimensions]);\n  React.useEffect(function () {\n    setThrottleBlur(props.throttleBlur && true);\n  }, [props.throttleBlur]);\n\n  var _onFinishEditing = function onFinishEditing() {\n    return __awaiter(_this, void 0, void 0, _regeneratorRuntime.mark(function _callee2() {\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              setProcessing(false);\n              props.onEditingComplete(imageData);\n              onCloseEditor();\n\n            case 3:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2);\n    }));\n  };\n\n  var onCloseEditor = function onCloseEditor() {\n    noScroll.off();\n    props.onCloseEditor();\n  };\n\n  React.useEffect(function () {\n    if (!props.visible) {\n      setReady(false);\n    }\n  }, [props.visible]);\n  return React.createElement(React.Fragment, null, React.createElement(react_native_1.StatusBar, {\n    hidden: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 120,\n      columnNumber: 7\n    }\n  }), React.createElement(react_native_1.SafeAreaView, {\n    style: {\n      height: \"100%\",\n      width: \"100%\",\n      position: \"absolute\",\n      top: 0,\n      left: 0,\n      zIndex: 1000000,\n      elevation: 1000000,\n      opacity: props.visible ? 1.0 : 0.0\n    },\n    pointerEvents: props.visible ? \"auto\" : \"none\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 121,\n      columnNumber: 7\n    }\n  }, ready ? React.createElement(react_native_1.View, {\n    style: styles.container,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 131,\n      columnNumber: 19\n    }\n  }, React.createElement(ControlBar_1.ControlBar, {\n    onPressBack: function onPressBack() {\n      return editingMode == \"operation-select\" ? props.onCloseEditor() : setEditingMode(\"operation-select\");\n    },\n    onFinishEditing: function onFinishEditing() {\n      return _onFinishEditing();\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 132,\n      columnNumber: 13\n    }\n  }), React.createElement(EditingWindow_1.EditingWindow, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 135,\n      columnNumber: 13\n    }\n  }), React.createElement(OperationBar_1.OperationBar, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 136,\n      columnNumber: 13\n    }\n  })) : null, processing ? React.createElement(Processing_1.Processing, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 138,\n      columnNumber: 23\n    }\n  }) : null));\n}\n\nfunction ImageEditor(props) {\n  return React.createElement(recoil_1.RecoilRoot, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 143,\n      columnNumber: 13\n    }\n  }, React.createElement(ImageEditorCore, _extends({}, props, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 144,\n      columnNumber: 7\n    }\n  })));\n}\n\nexports.ImageEditor = ImageEditor;\nvar styles = react_native_1.StyleSheet.create({\n  container: {\n    flex: 1,\n    backgroundColor: \"#222\"\n  }\n});","map":{"version":3,"sources":["../src/ImageEditor.tsx"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || function (mod) {\n    if (mod && mod.__esModule) return mod;\n    var result = {};\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n    __setModuleDefault(result, mod);\n    return result;\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.ImageEditor = void 0;\nconst React = __importStar(require(\"react\"));\nconst react_native_1 = require(\"react-native\");\nconst ControlBar_1 = require(\"./ControlBar\");\nconst EditingWindow_1 = require(\"./EditingWindow\");\nconst ImageManipulator = __importStar(require(\"expo-image-manipulator\"));\nconst Processing_1 = require(\"./Processing\");\nconst recoil_1 = require(\"recoil\");\nconst Store_1 = require(\"./Store\");\nconst OperationBar_1 = require(\"./OperationBar/OperationBar\");\nconst noScroll = require(\"no-scroll\");\nfunction ImageEditorCore(props) {\n    const [imageBounds, setImageBounds] = recoil_1.useRecoilState(Store_1.imageBoundsState);\n    const [imageData, setImageData] = recoil_1.useRecoilState(Store_1.imageDataState);\n    const [accumulatedPan, setAccumulatedPan] = recoil_1.useRecoilState(Store_1.accumulatedPanState);\n    const [imageScaleFactor] = recoil_1.useRecoilState(Store_1.imageScaleFactorState);\n    const [cropSize, setCropSize] = recoil_1.useRecoilState(Store_1.cropSizeState);\n    const [ready, setReady] = recoil_1.useRecoilState(Store_1.readyState);\n    const [processing, setProcessing] = recoil_1.useRecoilState(Store_1.processingState);\n    const [editingMode, setEditingMode] = recoil_1.useRecoilState(Store_1.editingModeState);\n    const [, setFixedCropAspectRatio] = recoil_1.useRecoilState(Store_1.fixedCropAspectRatioState);\n    const [, setLockAspectRatio] = recoil_1.useRecoilState(Store_1.lockAspectRatioState);\n    const [, setMinimumCropDimensions] = recoil_1.useRecoilState(Store_1.minimumCropDimensionsState);\n    const [, setThrottleBlur] = recoil_1.useRecoilState(Store_1.throttleBlurState);\n    // Initialise the image data when it is set through the props\n    React.useEffect(() => {\n        (() => __awaiter(this, void 0, void 0, function* () {\n            if (props.imageUri) {\n                const enableEditor = () => {\n                    setReady(true);\n                    // Set no-scroll to on\n                    noScroll.on();\n                };\n                // Platform check\n                if (react_native_1.Platform.OS == \"web\") {\n                    var img = document.createElement(\"img\");\n                    img.onload = () => {\n                        setImageData({\n                            uri: props.imageUri,\n                            height: img.height,\n                            width: img.width,\n                        });\n                        enableEditor();\n                    };\n                    img.src = props.imageUri;\n                }\n                else {\n                    const { width: pickerWidth, height: pickerHeight, } = yield ImageManipulator.manipulateAsync(props.imageUri, []);\n                    setImageData({\n                        uri: props.imageUri,\n                        width: pickerWidth,\n                        height: pickerHeight,\n                    });\n                    enableEditor();\n                }\n            }\n        }))();\n    }, [props.imageUri]);\n    // Initialise / update the crop AR / AR lock / min crop dims set through props\n    React.useEffect(() => {\n        setFixedCropAspectRatio(props.fixedCropAspectRatio);\n    }, [props.fixedCropAspectRatio]);\n    React.useEffect(() => {\n        setLockAspectRatio(props.lockAspectRatio);\n    }, [props.lockAspectRatio]);\n    React.useEffect(() => {\n        setMinimumCropDimensions(props.minimumCropDimensions);\n    }, [props.minimumCropDimensions]);\n    React.useEffect(() => {\n        setThrottleBlur(props.throttleBlur && true);\n    }, [props.throttleBlur]);\n    const onFinishEditing = () => __awaiter(this, void 0, void 0, function* () {\n        setProcessing(false);\n        props.onEditingComplete(imageData);\n        onCloseEditor();\n    });\n    const onCloseEditor = () => {\n        // Set no-scroll to off\n        noScroll.off();\n        props.onCloseEditor();\n    };\n    React.useEffect(() => {\n        // Reset the state of things and only render the UI\n        // when this state has been initialised\n        if (!props.visible) {\n            setReady(false);\n        }\n    }, [props.visible]);\n    return (<>\n      <react_native_1.StatusBar hidden/>\n      <react_native_1.SafeAreaView style={{\n        height: \"100%\",\n        width: \"100%\",\n        position: \"absolute\",\n        top: 0,\n        left: 0,\n        zIndex: 1000000,\n        elevation: 1000000,\n        opacity: props.visible ? 1.0 : 0.0,\n    }} pointerEvents={props.visible ? \"auto\" : \"none\"}>\n        {ready ? (<react_native_1.View style={styles.container}>\n            <ControlBar_1.ControlBar onPressBack={() => editingMode == \"operation-select\"\n        ? props.onCloseEditor()\n        : setEditingMode(\"operation-select\")} onFinishEditing={() => onFinishEditing()}/>\n            <EditingWindow_1.EditingWindow />\n            <OperationBar_1.OperationBar />\n          </react_native_1.View>) : null}\n        {processing ? <Processing_1.Processing /> : null}\n      </react_native_1.SafeAreaView>\n    </>);\n}\nfunction ImageEditor(props) {\n    return (<recoil_1.RecoilRoot>\n      <ImageEditorCore {...props}/>\n    </recoil_1.RecoilRoot>);\n}\nexports.ImageEditor = ImageEditor;\nconst styles = react_native_1.StyleSheet.create({\n    container: {\n        flex: 1,\n        backgroundColor: \"#222\",\n    },\n});\n//# sourceMappingURL=ImageEditor.js.map"]},"metadata":{},"sourceType":"script"}